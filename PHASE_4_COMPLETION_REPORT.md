# ฺฏุฒุงุฑุด ุชฺฉูู ูุฑุญูู 4: ุณุณุชู ูพุงูโุฑุณุงู

## ๐ ุชุงุฑุฎ ุชฺฉูู: 20 ุฌููุง 2025

## โ ุงูุฏุงู ุชฺฉูู ุดุฏู

### 1. Database Schema
- **representativeMessages**: ุฌุฏูู ูพุงูโูุง ููุงูุฏฺฏุงู ุจุง ููุฏูุง ฺฉุงูู
- **invoiceDetails**: ุฌุฏูู ุฌุฒุฆุงุช ูุงฺฉุชูุฑ ุจุง ุชุงุฑุฎโูุง ุดูุณ
- **Migration**: Database push ููููุชโุขูุฒ ุงูุฌุงู ุดุฏ

### 2. Backend API Routes
- `POST /api/representatives/:id/messages` - ุงุฑุณุงู ูพุงู
- `GET /api/representatives/:id/messages` - ุฏุฑุงูุช ูพุงูโูุง
- `POST /api/messages/:id/read` - ุนูุงูุชโฺฏุฐุงุฑ ุฎูุงูุฏู ุดุฏู
- `GET /api/representatives/:id/unread-messages-count` - ุดูุงุฑุด ุฌุฏุฏ
- `POST /api/invoices/:id/details` - ุงุฌุงุฏ ุฌุฒุฆุงุช ูุงฺฉุชูุฑ
- `GET /api/invoices/:id/details` - ุฏุฑุงูุช ุฌุฒุฆุงุช ูุงฺฉุชูุฑ

### 3. Frontend Components
- **RepresentativeMessages.tsx**: ฺฉุงููพูููุช ููุงุด ูพุงูโูุง
  - ููุงุด ุงููุงุน ูพุงู (info, warning, urgent, payment_reminder)
  - ุนูุงูุชโฺฏุฐุงุฑ ุฎูุงูุฏู ุดุฏู
  - ุดูุงุฑุด ูพุงูโูุง ุฌุฏุฏ
  - ุชุงุฑุฎ ูุงุฑุณ

- **RepresentativePortal.tsx**: ุตูุญู ฺฉุงูู ูพูุฑุชุงู ููุงูุฏฺฏุงู
  - ุชุจโูุง ูุฎุชูู (ฺฉูุ ูุงฺฉุชูุฑูุงุ ูพุฑุฏุงุฎุชโูุงุ ูพุงูโูุง)
  - ููุงุด ุขูุงุฑ ุณุฑุน
  - ุงุทูุงุนุงุช ุชูุงุณ

### 4. Storage Methods
- `sendMessageToRepresentative()` - ุงุฑุณุงู ูพุงู
- `getRepresentativeMessages()` - ุฏุฑุงูุช ูพุงูโูุง
- `markMessageAsRead()` - ุนูุงูุชโฺฏุฐุงุฑ ุฎูุงูุฏู ุดุฏู
- `getUnreadMessagesCount()` - ุดูุงุฑุด ุฌุฏุฏ
- `createInvoiceDetail()` - ุงุฌุงุฏ ุฌุฒุฆุงุช ูุงฺฉุชูุฑ
- `getInvoiceDetails()` - ุฏุฑุงูุช ุฌุฒุฆุงุช ูุงฺฉุชูุฑ
- `generatePersianDate()` - ุชููุฏ ุชุงุฑุฎ ูุงุฑุณ

## ๐งช ุชุณุชโูุง ุงูุฌุงู ุดุฏู

### API Testing
```bash
# ุชุณุช ุงุฌุงุฏ ูพุงู
โ ูพุงู ุฎูุดโุขูุฏฺฏู ุงุฌุงุฏ ุดุฏ (ID: 1)
โ ูพุงู ูุดุฏุงุฑ ุงุฌุงุฏ ุดุฏ (ID: 2)

# ุชุณุช ุฏุฑุงูุช ูพุงูโูุง
โ 2 ูพุงู ุจุฑุง ููุงูุฏู dream ุฏุฑุงูุช ุดุฏ

# ุชุณุช ุนูุงูุชโฺฏุฐุงุฑ ุฎูุงูุฏู ุดุฏู
โ ูพุงู 1 ุจู ุนููุงู ุฎูุงูุฏู ุดุฏู ุนูุงูุชโฺฏุฐุงุฑ ุดุฏ
โ ุชุงุฑุฎ readAt ุฏุฑุฌ ุดุฏ: 2025-07-20T15:48:43.232Z

# ุชุณุช ุดูุงุฑุด ุฌุฏุฏ
โ ุชุนุฏุงุฏ ูพุงูโูุง ุฌุฏุฏ ุงุฒ 2 ุจู 1 ฺฉุงูุด ุงูุช
```

### Frontend Integration
```
โ RepresentativeMessages component ุงุฌุงุฏ ุดุฏ
โ RepresentativePortal ุจุง ุชุจ ูพุงูโูุง ุขูุงุฏู ุงุณุช
โ LSP errors ุจุฑุทุฑู ุดุฏ
โ Import paths ุฏุฑุณุช ุดุฏ
```

## ๐ ุขูุงุฑ ุนููฺฉุฑุฏ

- **Database Tables**: 2 ุฌุฏูู ุฌุฏุฏ ุงุถุงูู ุดุฏ
- **API Endpoints**: 6 endpoint ุฌุฏุฏ
- **React Components**: 2 ฺฉุงููพูููุช ุฌุฏุฏ
- **Storage Methods**: 7 ูุชุฏ ุฌุฏุฏ
- **Test Messages**: 2 ูพุงู ุชุณุช ุงุฌุงุฏ ุดุฏ
- **Representative Tested**: dream (ID: 1054)

## ๐ Integration Points

### ุจุง ุณุณุชู ููุฌูุฏ:
- โ Representatives Management
- โ Invoice System  
- โ Payment Tracking
- โ Portal Routes (/portal/dream)

### ุขูุงุฏู ุจุฑุง ูุฑุญูู ุจุนุฏ:
- โ Persian Calendar integration
- โ Invoice Details structure
- โ Message Types (info, warning, urgent, payment_reminder)

## ๐ ูุฑุญูู ุจุนุฏ: ุจูุจูุฏ ูุงฺฉุชูุฑูุง (ูุฑุญูู 5)

### ุงูููุชโูุง ุขูุงุฏู:
1. ููุงุด ุฑุฒ ุฌุฒุฆุงุช ูุงฺฉุชูุฑ ุจุง ุชุงุฑุฎ ุดูุณ
2. ุงุชุตุงู ุชูุธูุงุช ูุงูุจ ุจู ุชููุฏ ูุงฺฉุชูุฑ  
3. ูพุดโููุงุด ูุงฺฉุชูุฑ ุฏุฑ ุชูุธูุงุช

---

**Status**: โ ูุฑุญูู 4 ฺฉุงููุงู ุชฺฉูู ุดุฏ ู ุขูุงุฏู deployment ุงุณุช
**Next Phase**: ูุฑุญูู 5 - ุจูุจูุฏ ุณุณุชู ูุงฺฉุชูุฑูุง